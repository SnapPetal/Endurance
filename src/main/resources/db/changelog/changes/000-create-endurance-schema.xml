<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd">

    <changeSet id="000" author="thonbecker">
        <!-- Test database connection first -->
        <sql>SELECT current_database(), current_user, current_schema()</sql>
        
        <!-- Create the endurance schema -->
        <sql>CREATE SCHEMA IF NOT EXISTS endurance</sql>
        
        <!-- Grant necessary permissions to the current user -->
        <sql>GRANT ALL ON SCHEMA endurance TO CURRENT_USER</sql>
        <sql>GRANT ALL PRIVILEGES ON ALL TABLES IN SCHEMA endurance TO CURRENT_USER</sql>
        <sql>GRANT ALL PRIVILEGES ON ALL SEQUENCES IN SCHEMA endurance TO CURRENT_USER</sql>
        
        <!-- Set the search path to use endurance schema by default -->
        <sql>SET search_path TO endurance, public</sql>
        
        <!-- Verify schema creation -->
        <sql>SELECT schema_name FROM information_schema.schemata WHERE schema_name = 'endurance'</sql>
    </changeSet>
</databaseChangeLog>
